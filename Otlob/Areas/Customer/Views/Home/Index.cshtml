@model CustomerHomeResponse

@{
    ViewData["Title"] = "Restaurants";
}

<link href="~/css/customerHome.css" rel="stylesheet" asp-append-version="true"/>

<div class="ch-container">
    <!-- Search Section -->
    <div class="ch-search-section">
        <div class="ch-search-wrapper">
            <i class="fas fa-search ch-search-icon"></i>
            <input type="text" id="searchInput" class="ch-search-input" placeholder="Search for restaurants, cuisines..." />
        </div>
    </div>

    <!-- Categories Section -->
    <div class="ch-categories-section">
        <div class="ch-categories-scroll">
            @foreach (var category in Model.Categories)
            {
                <div class="ch-category-item" data-category="@category">
                    <img src="/images/icons/@(category).png" alt="@category" class="ch-cat-icon"/>
                    <span class="ch-cat-name">@category</span>
                </div>
            }
        </div>
    </div>

    <!-- Filters Section -->
    <div class="ch-filters-section">
        <button class="ch-filter-btn" data-filter="highRating">
            <i class="fas fa-star"></i> High Rating
        </button>
        <button class="ch-filter-btn" data-filter="freeDelivery">
            <i class="fas fa-tag"></i> Free Delivery
        </button>
        <button class="ch-filter-btn" data-filter="fastDelivery">
            <i class="fas fa-stopwatch"></i> Fast Delivery
        </button>
        <button class="ch-filter-btn" data-filter="businessType" data-value="Restaurant">
            <i class="fas fa-utensils"></i> Restaurant
        </button>
        <button class="ch-filter-btn" data-filter="businessType" data-value="StreetFood">
            <i class="fas fa-hamburger"></i> Street Food
        </button>
        <button class="ch-filter-btn" data-filter="businessType" data-value="CloudKitchen">
            <i class="fas fa-cloud"></i> Cloud Kitchen
        </button>
    </div>

    <!-- Restaurants Grid -->
    <div id="restaurantsGrid" class="ch-restaurants-grid">
        @foreach (var item in Model.Restaurants)
        {
            <a asp-controller="Menu" asp-action="Menu" asp-route-restaurantKey="@item.Key" class="ch-restaurant-card"
               data-name="@item.Name"
               data-categories="@string.Join(",", item.Categories)"
               data-delivery-fee="@item.DeliveryFee"
               data-delivery-duration="@item.DeliveryDuration"
               data-business-type="@item.BusinessType"
               data-rating="@item.Rating">
                
                <div class="ch-card-img-wrapper">
                    <img src="/images/@(item.Image ?? "Default.jpg")" alt="@item.Name" class="ch-card-img" />
                    @if (item.IsClosed)
                    {
                        <span class="ch-status-badge status-closed">Closed</span>
                    }
                    else if (item.Status == AcctiveStatus.Warning)
                    {
                        <span class="ch-status-badge status-busy">Busy</span>
                    }
                </div>
                
                <div class="ch-card-content">
                    <div>
                        <div class="ch-res-header">
                            <h3 class="ch-res-name">@item.Name</h3>
                            @if (item.Rating > 0)
                            {
                                <div class="ch-rating-wrapper">
                                    <i class="fas fa-star ch-star-icon"></i>
                                    <span class="ch-rating-text">@((item.Rating / 5m * 100).ToString("0"))%</span>
                                </div>
                            }
                            else
                            {
                                <div class="ch-rating-wrapper">
                                    <i class="fas fa-star ch-star-icon"></i>
                                    <span class="ch-rating-text">New</span>
                                </div>
                            }
                        </div>
                        <div class="ch-res-tags">
                            @string.Join(", ", item.Categories.Take(3))
                        </div>

                        <div class="ch-res-footer">
                            <span class="ch-delivery-fee @(item.DeliveryFee == 0 ? "free" : "")">
                                @if(item.DeliveryFee == 0)
                                {
                                    <span>Free</span>
                                }
                                else
                                {
                                    <span>@item.DeliveryFee.ToString("0.00") L.E</span>
                                }
                            </span>
                            
                            <div class="ch-meta-item">
                                <i class="fas fa-clock"></i> @item.DeliveryDuration.ToString("0") min
                            </div>
                        </div>
                    </div>
                </div>
            </a>
        }
        
        <div id="noResults" class="ch-no-results">
            <i class="fas fa-search"></i>
            <h3>No restaurants found</h3>
            <p>Try adjusting your search or filters</p>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_NotificationPartial"></partial>
    <script src="~/js/customerHome.js" asp-append-version="true"></script>
}