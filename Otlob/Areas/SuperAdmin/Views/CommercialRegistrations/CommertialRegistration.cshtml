@model CommercialRegistrationResponse

@{
    ViewData["Title"] = "Commercial Registration";
}

<link rel="stylesheet" href="~/css/documents.css" asp-append-version="true" />

<div class="doc-page">
    <!-- Hero Section -->
    <div class="doc-hero">
        <div class="doc-hero-content">
            <div class="doc-hero-top">
                <a class="doc-back-btn" 
                   asp-area="SuperAdmin"
                   asp-controller="Restaurants" 
                   asp-action="ResturantDetails" 
                   asp-route-id="@Model.RestaurantId">
                    <i class="fas fa-arrow-left"></i>
                    Back to Restaurant
                </a>
                <span class="doc-status-badge status-@Model.DocumentStatus.ToString().ToLower()">
                    @if (Model.DocumentStatus == DocumentStatus.Accepted)
                    {
                        <i class="fas fa-check-circle"></i>
                    }
                    else if (Model.DocumentStatus == DocumentStatus.Rejected)
                    {
                        <i class="fas fa-times-circle"></i>
                    }
                    else
                    {
                        <i class="fas fa-clock"></i>
                    }
                    @Model.DocumentStatus
                </span>
            </div>
            <div class="doc-hero-main">
                <div class="doc-icon-wrapper">
                    <i class="fas fa-file-contract"></i>
                </div>
                <div class="doc-hero-info">
                    <h1 class="doc-title">Commercial Registration</h1>
                    <p class="doc-subtitle">Official business registration certificate for legal verification</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="doc-main">
        <!-- Quick Stats -->
        <div class="doc-quick-stats">
            <div class="doc-stat-card">
                <div class="doc-stat-icon primary">
                    <i class="fas fa-hashtag"></i>
                </div>
                <div class="doc-stat-content">
                    <div class="doc-stat-value">@Model.RegistrationNumber</div>
                    <div class="doc-stat-label">Registration No.</div>
                </div>
            </div>
            <div class="doc-stat-card">
                <div class="doc-stat-icon success">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <div class="doc-stat-content">
                    <div class="doc-stat-value">@Model.DateOfIssuance.ToString("MMM yyyy")</div>
                    <div class="doc-stat-label">Issued Date</div>
                </div>
            </div>
            <div class="doc-stat-card">
                <div class="doc-stat-icon @(Model.ExpiryDate > DateOnly.FromDateTime(DateTime.Now) ? "warning" : "danger")">
                    <i class="fas fa-calendar-times"></i>
                </div>
                <div class="doc-stat-content">
                    <div class="doc-stat-value">@(Model.ExpiryDate.ToDateTime(TimeOnly.MinValue).Subtract(DateTime.Now).Days) days</div>
                    <div class="doc-stat-label">@(Model.ExpiryDate > DateOnly.FromDateTime(DateTime.Now) ? "Until Expiry" : "Expired")</div>
                </div>
            </div>
        </div>

        <div class="doc-content-grid">
            <!-- Left Column - Info Cards -->
            <div class="doc-info-column">
                <!-- Registration Details Card -->
                <div class="doc-card">
                    <div class="doc-card-header">
                        <h2 class="doc-card-title">
                            <i class="fas fa-info-circle"></i>
                            Registration Details
                        </h2>
                    </div>
                    <div class="doc-card-body">
                        <div class="doc-info-grid">
                            <div class="doc-info-item full-width">
                                <div class="doc-info-icon">
                                    <i class="fas fa-hashtag"></i>
                                </div>
                                <div class="doc-info-content">
                                    <span class="doc-info-label">Registration Number</span>
                                    <div class="doc-info-value">@Model.RegistrationNumber</div>
                                </div>
                            </div>
                            <div class="doc-info-item">
                                <div class="doc-info-icon">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <div class="doc-info-content">
                                    <span class="doc-info-label">Date of Issuance</span>
                                    <div class="doc-info-value">@Model.DateOfIssuance.ToString("MMMM dd, yyyy")</div>
                                </div>
                            </div>
                            <div class="doc-info-item">
                                <div class="doc-info-icon">
                                    <i class="fas fa-calendar-times"></i>
                                </div>
                                <div class="doc-info-content">
                                    <span class="doc-info-label">Expiry Date</span>
                                    <div class="doc-info-value">@Model.ExpiryDate.ToString("MMMM dd, yyyy")</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Verification Status Card -->
                <div class="doc-card">
                    <div class="doc-card-header">
                        <h2 class="doc-card-title">
                            <i class="fas fa-clipboard-check"></i>
                            Verification Status
                        </h2>
                    </div>
                    <div class="doc-card-body">
                        <div class="doc-info-grid">
                            <div class="doc-info-item">
                                <div class="doc-info-icon">
                                    <i class="fas fa-flag"></i>
                                </div>
                                <div class="doc-info-content">
                                    <span class="doc-info-label">Current Status</span>
                                    <div class="doc-info-value">@Model.DocumentStatus</div>
                                </div>
                            </div>
                            <div class="doc-info-item">
                                <div class="doc-info-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="doc-info-content">
                                    <span class="doc-info-label">Document Validity</span>
                                    <div class="doc-info-value">@(Model.ExpiryDate > DateOnly.FromDateTime(DateTime.Now) ? "Valid" : "Expired")</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column - Sidebar -->
            <div class="doc-sidebar">
                <!-- Certificate File -->
                <div class="doc-file-card">
                    <h3>
                        <i class="fas fa-file-contract"></i>
                        Certificate File
                    </h3>
                    <div class="doc-file-icon">
                        <i class="fas fa-file-pdf"></i>
                    </div>
                    <div class="doc-file-name">@Model.CertificateRegistration.FileName</div>
                    <div class="doc-file-actions">
                        <a asp-area="SuperAdmin"
                           asp-controller="Documents" 
                           asp-action="Download" 
                           asp-route-id="@Model.CertificateRegistration.Id"
                           class="doc-btn doc-btn-download">
                            <i class="fas fa-download"></i>
                            Download
                        </a>
                    </div>
                </div>

                <!-- Status Actions Card -->
                <div class="doc-action-card">
                    <div class="doc-action-header">
                        <h3 class="doc-action-title">
                            <i class="fas fa-sliders-h"></i>
                            Change Status
                        </h3>
                    </div>
                    <div class="doc-action-body">
                        @foreach (var status in Enum.GetValues<DocumentStatus>())
                        {
                            @if (status != Model.DocumentStatus)
                            {
                                <a asp-area="SuperAdmin"
                                   asp-controller="CommercialRegistrations"
                                   asp-action="ChangeCommercialRegistrationDocumentStatus" 
                                   asp-route-id="@Model.Id"
                                   asp-route-status="@status"
                                   asp-route-restaurantId="@Model.RestaurantId"
                                   class="doc-btn-status @(status == DocumentStatus.Accepted ? "doc-btn-accept" : status == DocumentStatus.Rejected ? "doc-btn-reject" : "doc-btn-pending")">
                                    @if (status == DocumentStatus.Accepted)
                                    {
                                        <i class="fas fa-check"></i>
                                    }
                                    else if (status == DocumentStatus.Rejected)
                                    {
                                        <i class="fas fa-times"></i>
                                    }
                                    else
                                    {
                                        <i class="fas fa-clock"></i>
                                    }
                                    @status.ToString()
                                </a>
                            }
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_NotificationPartial"></partial>
}
