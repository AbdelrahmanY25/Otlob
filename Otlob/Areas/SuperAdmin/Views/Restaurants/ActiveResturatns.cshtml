@model IQueryable<AcctiveRestaurantResponse>

@{
    ViewData["Title"] = "Acctive Restaurant Approvals";
    var restaurantsList = Model.ToList();
    var totalCount = restaurantsList.Count;
}

    <link rel="stylesheet" href="~/css/pendingRestaurants.css" asp-append-version="true" />

    <div class="pr-page">
        <div class="pr-container">
            <!-- Header Section -->
            <div class="pr-header">
                <div class="pr-header-content">
                    <div class="pr-header-icon">
                        <i class="fas fa-store-alt"></i>
                    </div>
                    <div class="pr-header-text">
                        <h3>Accepted Restaurant</h3>
                    </div>
                </div>
                @if (totalCount > 0)
                {
                    <div class="pr-header-stats">
                        <span class="pr-stat-count">@totalCount</span>
                    </div>
                }
            </div>

            @if (totalCount > 0)
            {
                <!-- Search Bar -->
                <div class="pr-search-wrapper">
                    <div class="pr-search-box">
                        <i class="fas fa-search"></i>
                        <input type="text"
                               id="restaurantSearch"
                               placeholder="Search by name..."
                               aria-label="Search restaurants" />
                    </div>
                </div>

                <!-- Restaurants Table -->
                <div class="pr-table-wrapper">
                    <table class="pr-table">
                        <thead>
                            <tr>
                                <th>Restaurant</th>
                                <th>Status</th>
                                <th class="pr-action-col">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var restaurant in restaurantsList)
                            {
                                <tr class="pr-table-row" data-search-terms="@(restaurant.Name.ToLower())">
                                    <td data-label="Restaurant">
                                        <div class="pr-restaurant-info">
                                            <img src="/images/@(restaurant.Image ?? "Default.jpg")"
                                                 alt="@restaurant.Name"
                                                 class="pr-restaurant-logo"
                                                 onerror="this.src='/images/Default.jpg'"
                                                 loading="lazy" />
                                            <div class="pr-restaurant-name">
                                                @restaurant.Name
                                            </div>
                                        </div>
                                    </td>
                                    <td data-label="Status">
                                        <span class="pr-status-badge pr-status-@restaurant.Status.ToString().ToLower()">
                                            @restaurant.Status
                                        </span>
                                    </td>
                                    <td data-label="Actions" class="pr-action-col">
                                        <a asp-action="ResturantDetails"
                                           asp-route-id="@restaurant.Key"
                                           class="pr-btn pr-btn-primary">
                                            <i class="fas fa-eye"></i>
                                            <span>Details</span>
                                        </a>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>

                <!-- No Results State -->
                <div class="pr-no-results" style="display: none;">
                    <div class="pr-empty-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <h3>No restaurants found</h3>
                    <p>Try adjusting your search terms</p>
                </div>
            }
            else
            {
                <!-- Empty State -->
                <div class="pr-empty">
                    <div class="pr-empty-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3>All Caught Up!</h3>
                    <p>There are no restaurant yet.</p>
                </div>
            }
        </div>
    </div>

@section Scripts {
        <partial name="_NotificationPartial" />
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const searchInput = document.getElementById('restaurantSearch');
                const tableRows = document.querySelectorAll('.pr-table-row');
                const noResults = document.querySelector('.pr-no-results');
                const tableWrapper = document.querySelector('.pr-table-wrapper');

                if (searchInput) {
                    searchInput.addEventListener('input', function() {
                        const searchTerm = this.value.toLowerCase().trim();
                        let visibleCount = 0;

                        tableRows.forEach(row => {
                            const searchTerms = row.getAttribute('data-search-terms');
                            if (searchTerms.includes(searchTerm)) {
                                row.style.display = '';
                                visibleCount++;
                            } else {
                                row.style.display = 'none';
                            }
                        });

                        if (tableWrapper) {
                            tableWrapper.style.display = visibleCount > 0 ? '' : 'none';
                        }
                        if (noResults) {
                            noResults.style.display = visibleCount === 0 ? 'flex' : 'none';
                        }
                    });

                    document.addEventListener('keydown', function(e) {
                        if (e.ctrlKey && e.key === 'k') {
                            e.preventDefault();
                            searchInput.focus();
                        }
                    });
                }
            });
        </script>
}
